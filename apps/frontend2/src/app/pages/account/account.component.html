@let model = account.value();
@if (model) {
    <div class="container mt-4">
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">{{ model.name }}</h2>
                <h3 class="card-subtitle mb-2 text-muted">
                    Balance: {{ formatCurrency(model.balance) }}
                </h3>
            </div>
        </div>

        <h4>
            Transactions
            <button
                ejs-button
                cssClass="e-small e-flat"
                (click)="showTransactionModal()"
            >
                <span class="fs-4">+</span>
            </button>
        </h4>
        <ejs-grid [dataSource]="transactions.value()">
            <e-columns>
                <e-column
                    field="date"
                    headerText="Date"
                    format="yMd"
                ></e-column>
                <e-column
                    field="description"
                    headerText="Description"
                ></e-column>
                <e-column
                    field="amount"
                    headerText="Amount"
                    format="N2"
                    textAlign="Right"
                    [width]="150"
                />
            </e-columns>
        </ejs-grid>
    </div>
} @else if (account.isLoading()) {
    <div class="container mt-4">
        <div class="alert alert-info" role="alert">
            Loading...
        </div>
    </div>
} @else {
    <div class="container mt-4">
        <div class="alert alert-warning" role="alert">
            Account not found
        </div>
    </div>
}

<div id="dialog-container">
    <ejs-dialog
        #transactionDialog
        target="#dialog-container"
        [header]='"New Transaction"'
        [showCloseIcon]="true"
        [isModal]="true"
        [visible]="false"
        [width]="400"
    >
        <ng-template #content>
            <div>
                <form
                    #transactionForm="ngForm"
                    (ngSubmit)="createTransaction()"
                >
                    <div class="mb-3">
                        <label class="form-label">Date</label>
                        <ejs-datepicker
                            [(value)]="newTransaction.date"
                            [format]='"dd/MM/yyyy"'
                            [showClearButton]="false"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <ejs-textbox
                            [(value)]="newTransaction.description"
                            placeholder="Enter description"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Amount</label>
                        <ejs-numerictextbox
                            [(value)]="newTransaction.amount"
                            [format]='"C2"'
                            locale="en-ID"
                            [min]="0"
                        ></ejs-numerictextbox>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Type</label>
                        <ejs-dropdownlist
                            [(value)]="newTransaction.type"
                            [dataSource]="transactionTypes"
                            [fields]="typeFields"
                        ></ejs-dropdownlist>
                    </div>
                    <div class="d-flex justify-content-end gap-2">
                        <button
                            ejs-button
                            cssClass="e-flat"
                            (click)="closeTransactionModal()"
                        >
                            Cancel
                        </button>
                        <button ejs-button cssClass="e-primary" type="submit">
                            Create
                        </button>
                    </div>
                </form>
            </div>
        </ng-template>
    </ejs-dialog>
</div>
